<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Challenge 1 - TCGA and The Curse of BigData &middot; RTCGA
    
  </title>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75667517-1', 'auto');
  ga('send', 'pageview');

</script>

  <!-- CSS -->
  <link rel="stylesheet" href="/RTCGA/public/css/poole.css">
  <link rel="stylesheet" href="/RTCGA/public/css/syntax.css">
  <link rel="stylesheet" href="/RTCGA/public/css/hyde.css">
  <link rel="stylesheet" href="/RTCGA/public/css/custom.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/RTCGApublic/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/RTCGApublic/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- Mathjax -->
  <script type="text/javascript"
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <!--Disqus comment counts-->
    <script id="dsq-count-scr" src="//RTCGA.disqus.com/count.js" async></script>
    
</head>


  <body class="theme-base-09">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/RTCGA">
          RTCGA
        </a>
      </h1>
      <p class="lead">Factory of R packages with TCGA data</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/RTCGA">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/RTCGA/Applications.html">Web Applications</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/RTCGA/Cox.html">Cox Survival Analysis</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/RTCGA/Download.html">TCGA Data Download</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item active" href="/RTCGA/Usecases.html">Challenge 1 - TCGA and The Curse of BigData</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/RTCGA/Visualizations.html">Visualizations</a>
          
        
      
        
      
        
      
      <a class="sidebar-nav-item" href="https://github.com/RTCGA/RTCGA">GitHub project</a>
    </nav>
  </div>
</div>


    <div class="content container">
      <div class="page">
  <h1 class="page-title">Challenge 1 - TCGA and The Curse of BigData</h1>
  
<h1 id="goals">Goals</h1>

<p>Here we are presenting some non-standard analyses of RTCGA data.</p>

<ol>
  <li>
    <p>Starting with BRCA cohort, we check how the number of cases is increasing through consecutive releases.</p>
  </li>
  <li>
    <p>We are checking how p-values for simple log-rank model are changing through consecutive releases</p>
  </li>
  <li>
    <p>We are showing that (due to number of genes) some of them have expression confounded with significant clinical outcomes.</p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">RTCGA</span><span class="p">)</span></code></pre></figure>

<h1 id="download-clinical-datasets">1. Download clinical datasets</h1>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">releaseDates</span> <span class="o">&lt;-</span> <span class="n">checkTCGA</span><span class="p">(</span><span class="s2">"Dates"</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">archivist</span><span class="p">)</span>
<span class="n">createLocalRepo</span><span class="p">(</span><span class="s2">"UseCases"</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Directory UseCases did not exist. Forced to create a new directory.</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">releaseDates</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">try</span><span class="p">({</span>
    <span class="n">downloadTCGA</span><span class="p">(</span>
    	<span class="s2">"BRCA"</span><span class="p">,</span>
    	<span class="n">dataSet</span> <span class="o">=</span> <span class="s2">"Merge_Clinical.Level_1"</span><span class="p">,</span>
    	<span class="n">date</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span>
    	<span class="n">destDir</span> <span class="o">=</span> <span class="s2">"UseCases"</span>
    	<span class="p">)</span> 
    <span class="n">cat</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s2">"\n"</span><span class="p">)</span>
  <span class="p">},</span> <span class="n">silent</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h1 id="prepare-data">2. Prepare data</h1>

<h2 id="prepare-expression-dataset-with-rnaseq">2.1 Prepare expression dataset with RNAseq</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">RTCGA.rnaseq</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="n">BRCA.rnaseq.fil</span> <span class="o">&lt;-</span> <span class="n">BRCA.rnaseq</span> <span class="o">%&gt;%</span>
	<span class="n">filter</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">bcr_patient_barcode</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="m">15</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"01"</span><span class="p">)</span> <span class="o">%&gt;%</span>
	<span class="n">mutate</span><span class="p">(</span><span class="n">bcr_patient_barcode</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">bcr_patient_barcode</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">12</span><span class="p">))</span></code></pre></figure>

<h2 id="load-all-clinical-data">2.2 Load all clinical data</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">files</span> <span class="o">&lt;-</span> <span class="n">list.files</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s2">"UseCases"</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">"BRCA.clin.mer"</span><span class="p">,</span> <span class="n">recursive</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="n">files</span> <span class="o">&lt;-</span> <span class="n">file.path</span><span class="p">(</span><span class="s2">"UseCases"</span><span class="p">,</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># Here gather some useful statistics
</span><span class="n">n</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">()</span>
<span class="n">names</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">()</span>

<span class="c1"># Collect p-values for these genes
</span><span class="n">selected</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="m">23L</span><span class="p">,</span> <span class="m">228L</span><span class="p">,</span> <span class="m">259L</span><span class="p">,</span> <span class="m">309L</span><span class="p">,</span> <span class="m">593L</span><span class="p">,</span> <span class="m">664L</span><span class="p">,</span> <span class="m">665L</span><span class="p">,</span> <span class="m">675L</span><span class="p">,</span> <span class="m">676L</span><span class="p">,</span> <span class="m">717L</span><span class="p">,</span> 
             <span class="m">847L</span><span class="p">,</span> <span class="m">904L</span><span class="p">,</span> <span class="m">1148L</span><span class="p">,</span> <span class="m">1287L</span><span class="p">,</span> <span class="m">1306L</span><span class="p">,</span> <span class="m">1369L</span><span class="p">,</span> <span class="m">1429L</span><span class="p">,</span> <span class="m">1602L</span><span class="p">,</span> <span class="m">1718L</span><span class="p">,</span> 
             <span class="m">1818L</span><span class="p">,</span> <span class="m">1856L</span><span class="p">,</span> <span class="m">1985L</span><span class="p">,</span> <span class="m">2004L</span><span class="p">,</span> <span class="m">2034L</span><span class="p">,</span> <span class="m">2169L</span><span class="p">,</span> <span class="m">2176L</span><span class="p">,</span> <span class="m">2248L</span><span class="p">,</span> <span class="m">2389L</span><span class="p">,</span> 
             <span class="m">2478L</span><span class="p">,</span> <span class="m">2514L</span><span class="p">,</span> <span class="m">2550L</span><span class="p">,</span> <span class="m">2551L</span><span class="p">,</span> <span class="m">2555L</span><span class="p">,</span> <span class="m">2682L</span><span class="p">,</span> <span class="m">2944L</span><span class="p">,</span> <span class="m">3008L</span><span class="p">,</span> <span class="m">3153L</span><span class="p">,</span> 
             <span class="m">3189L</span><span class="p">,</span> <span class="m">3411L</span><span class="p">,</span> <span class="m">3640L</span><span class="p">,</span> <span class="m">3803L</span><span class="p">,</span> <span class="m">3817L</span><span class="p">,</span> <span class="m">3857L</span><span class="p">,</span> <span class="m">3960L</span><span class="p">,</span> <span class="m">4139L</span><span class="p">,</span> <span class="m">4157L</span><span class="p">,</span> 
             <span class="m">4192L</span><span class="p">,</span> <span class="m">4338L</span><span class="p">,</span> <span class="m">4588L</span><span class="p">,</span> <span class="m">4814L</span><span class="p">,</span> <span class="m">5179L</span><span class="p">,</span> <span class="m">5270L</span><span class="p">,</span> <span class="m">5694L</span><span class="p">,</span> <span class="m">5744L</span><span class="p">,</span> <span class="m">5764L</span><span class="p">,</span> 
             <span class="m">6028L</span><span class="p">,</span> <span class="m">6033L</span><span class="p">,</span> <span class="m">6544L</span><span class="p">,</span> <span class="m">6593L</span><span class="p">,</span> <span class="m">6680L</span><span class="p">,</span> <span class="m">6797L</span><span class="p">,</span> <span class="m">6798L</span><span class="p">,</span> <span class="m">6831L</span><span class="p">,</span> <span class="m">6844L</span><span class="p">,</span> 
             <span class="m">6847L</span><span class="p">,</span> <span class="m">6855L</span><span class="p">,</span> <span class="m">6878L</span><span class="p">,</span> <span class="m">7009L</span><span class="p">,</span> <span class="m">7067L</span><span class="p">,</span> <span class="m">7082L</span><span class="p">,</span> <span class="m">7261L</span><span class="p">,</span> <span class="m">7299L</span><span class="p">,</span> <span class="m">7430L</span><span class="p">,</span> 
             <span class="m">7529L</span><span class="p">,</span> <span class="m">7857L</span><span class="p">,</span> <span class="m">7971L</span><span class="p">,</span> <span class="m">7982L</span><span class="p">,</span> <span class="m">8015L</span><span class="p">,</span> <span class="m">8265L</span><span class="p">,</span> <span class="m">8284L</span><span class="p">,</span> <span class="m">8316L</span><span class="p">,</span> <span class="m">8694L</span><span class="p">,</span> 
             <span class="m">8706L</span><span class="p">,</span> <span class="m">8832L</span><span class="p">,</span> <span class="m">9400L</span><span class="p">,</span> <span class="m">9585L</span><span class="p">,</span> <span class="m">9593L</span><span class="p">,</span> <span class="m">9706L</span><span class="p">,</span> <span class="m">9734L</span><span class="p">,</span> <span class="m">9778L</span><span class="p">,</span> <span class="m">9858L</span><span class="p">,</span> 
             <span class="m">9872L</span><span class="p">,</span> <span class="m">9879L</span><span class="p">,</span> <span class="m">10206L</span><span class="p">,</span> <span class="m">10235L</span><span class="p">,</span> <span class="m">10295L</span><span class="p">,</span> <span class="m">10511L</span><span class="p">,</span> <span class="m">10634L</span><span class="p">,</span> <span class="m">10938L</span><span class="p">,</span> 
             <span class="m">10963L</span><span class="p">,</span> <span class="m">11162L</span><span class="p">,</span> <span class="m">11174L</span><span class="p">,</span> <span class="m">11197L</span><span class="p">,</span> <span class="m">11244L</span><span class="p">,</span> <span class="m">11257L</span><span class="p">,</span> <span class="m">11262L</span><span class="p">,</span> <span class="m">11346L</span><span class="p">,</span> 
             <span class="m">11554L</span><span class="p">,</span> <span class="m">11600L</span><span class="p">,</span> <span class="m">11713L</span><span class="p">,</span> <span class="m">11793L</span><span class="p">,</span> <span class="m">11876L</span><span class="p">,</span> <span class="m">11879L</span><span class="p">,</span> <span class="m">11890L</span><span class="p">,</span> <span class="m">11893L</span><span class="p">,</span> 
             <span class="m">11915L</span><span class="p">,</span> <span class="m">11916L</span><span class="p">,</span> <span class="m">11917L</span><span class="p">,</span> <span class="m">11947L</span><span class="p">,</span> <span class="m">11968L</span><span class="p">,</span> <span class="m">11971L</span><span class="p">,</span> <span class="m">11979L</span><span class="p">,</span> <span class="m">11994L</span><span class="p">,</span> 
             <span class="m">12007L</span><span class="p">,</span> <span class="m">12190L</span><span class="p">,</span> <span class="m">12257L</span><span class="p">,</span> <span class="m">12391L</span><span class="p">,</span> <span class="m">12403L</span><span class="p">,</span> <span class="m">12575L</span><span class="p">,</span> <span class="m">12912L</span><span class="p">,</span> <span class="m">13032L</span><span class="p">,</span> 
             <span class="m">13105L</span><span class="p">,</span> <span class="m">13451L</span><span class="p">,</span> <span class="m">13486L</span><span class="p">,</span> <span class="m">13531L</span><span class="p">,</span> <span class="m">13598L</span><span class="p">,</span> <span class="m">13617L</span><span class="p">,</span> <span class="m">13815L</span><span class="p">,</span> <span class="m">14053L</span><span class="p">,</span> 
             <span class="m">14129L</span><span class="p">,</span> <span class="m">14211L</span><span class="p">,</span> <span class="m">14289L</span><span class="p">,</span> <span class="m">14291L</span><span class="p">,</span> <span class="m">14313L</span><span class="p">,</span> <span class="m">14389L</span><span class="p">,</span> <span class="m">14423L</span><span class="p">,</span> <span class="m">14544L</span><span class="p">,</span> 
             <span class="m">14703L</span><span class="p">,</span> <span class="m">14725L</span><span class="p">,</span> <span class="m">14760L</span><span class="p">,</span> <span class="m">14910L</span><span class="p">,</span> <span class="m">14963L</span><span class="p">,</span> <span class="m">15101L</span><span class="p">,</span> <span class="m">15315L</span><span class="p">,</span> <span class="m">15363L</span><span class="p">,</span> 
             <span class="m">15392L</span><span class="p">,</span> <span class="m">15507L</span><span class="p">,</span> <span class="m">15696L</span><span class="p">,</span> <span class="m">15762L</span><span class="p">)</span>


<span class="n">read_and_joinTCGA</span> <span class="o">&lt;-</span> <span class="k">function</span><span class="p">(</span><span class="n">file</span><span class="p">){</span>
	<span class="n">readTCGA</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">dataType</span> <span class="o">=</span> <span class="s2">"clinical"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">clin</span>
	<span class="n">c</span><span class="p">(</span><span class="n">which</span><span class="p">(</span><span class="n">grepl</span><span class="p">(</span><span class="s1">'patient.stage_event.tnm_categories.pathologic_categories.pathologic_t'</span><span class="p">,</span> <span class="n">names</span><span class="p">(</span><span class="n">clin</span><span class="p">),</span> <span class="n">fixed</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)),</span>
	<span class="n">which</span><span class="p">(</span><span class="n">grepl</span><span class="p">(</span><span class="s1">'patient.stage.event.tnm.categories.pathologic.categories.pathologic.t'</span><span class="p">,</span> <span class="n">names</span><span class="p">(</span><span class="n">clin</span><span class="p">),</span> <span class="n">fixed</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)))</span> <span class="o">-&gt;</span>
		<span class="n">this.col</span>
	<span class="n">names</span><span class="p">(</span><span class="n">clin</span><span class="p">)[</span><span class="n">this.col</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s1">'stageevent'</span>
	<span class="n">clin</span> <span class="o">%&gt;%</span>
		<span class="n">filter</span><span class="p">(</span><span class="n">stageevent</span> <span class="o">!=</span> <span class="s2">"tx"</span><span class="p">)</span> <span class="o">%&gt;%</span>
		<span class="n">mutate</span><span class="p">(</span><span class="n">stageevent</span> <span class="o">=</span> 
					 	<span class="n">substr</span><span class="p">(</span><span class="n">stageevent</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span> <span class="o">%&gt;%</span>
		<span class="n">survivalTCGA</span><span class="p">(</span><span class="n">extract.cols</span> <span class="o">=</span> <span class="s2">"stageevent"</span><span class="p">,</span>
								 <span class="n">extract.names</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span> <span class="o">%&gt;%</span> 
		<span class="n">unique</span> <span class="o">%&gt;%</span>
		<span class="n">left_join</span><span class="p">(</span><span class="n">BRCA.rnaseq.fil</span><span class="p">,</span>
							<span class="n">by</span> <span class="o">=</span> <span class="s2">"bcr_patient_barcode"</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<h2 id="calculate-p-values-for-selected-genes">2.3 Calculate p-values for selected genes</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pvalues</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">length</span><span class="p">(</span><span class="n">selected</span><span class="p">))</span> <span class="o">-</span> <span class="m">1</span>
<span class="n">library</span><span class="p">(</span><span class="n">survival</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="n">seq_along</span><span class="p">(</span><span class="n">files</span><span class="p">))</span> <span class="p">{</span>
  <span class="n">try</span><span class="p">({</span>
    <span class="n">all</span> <span class="o">&lt;-</span> <span class="n">read_and_joinTCGA</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="k">in</span> <span class="n">seq_along</span><span class="p">(</span><span class="n">selected</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">selectedCat</span> <span class="o">&lt;-</span> <span class="n">cut</span><span class="p">(</span><span class="n">all</span><span class="p">[,</span><span class="n">selected</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="m">+4</span><span class="p">],</span> <span class="n">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span><span class="n">median</span><span class="p">(</span><span class="n">all</span><span class="p">[,</span><span class="n">selected</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="m">+4</span><span class="p">],</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">),</span><span class="m">10</span><span class="o">^</span><span class="m">9</span><span class="p">))</span>
      
      <span class="k">if</span> <span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="m">20</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ndf</span> <span class="o">&lt;-</span> <span class="n">data.frame</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">all</span><span class="o">$</span><span class="n">times</span><span class="p">,</span>
        									<span class="n">event</span> <span class="o">=</span> <span class="n">all</span><span class="o">$</span><span class="n">patient.vital_status</span> <span class="o">==</span><span class="m">1</span><span class="p">,</span>
        									<span class="n">var</span> <span class="o">=</span> <span class="n">selectedCat</span><span class="p">)</span>
        <span class="n">pvalues</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">survdiff</span><span class="p">(</span><span class="n">Surv</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span><span class="o">~</span><span class="n">var</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ndf</span><span class="p">)</span><span class="o">$</span><span class="n">chisq</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">nrow</span><span class="p">(</span><span class="n">all</span><span class="p">)</span>
    <span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="p">},</span> <span class="n">silent</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
	<span class="n">cat</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">"\n"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">saveToRepo</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "f9e884084b84794d762a535f3facec85"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">saveToRepo</span><span class="p">(</span><span class="n">files</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "5152ac13bdd09110d9ee9c169a3d9237"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">saveToRepo</span><span class="p">(</span><span class="n">pvalues</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "185cadffc15526273b38bb07fefb1cf2"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">saveToRepo</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "f9e884084b84794d762a535f3facec85"</code></pre></figure>

<h2 id="number-of-observations-in-brca--next-releases">3. Number of observations in BRCA / next releases</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">dates</span> <span class="o">&lt;-</span> <span class="n">substr</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="m">62</span><span class="p">,</span> <span class="m">69</span><span class="p">)</span>
<span class="n">drd</span> <span class="o">&lt;-</span> <span class="n">na.omit</span><span class="p">(</span><span class="n">data.frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ymd</span><span class="p">(</span><span class="n">dates</span><span class="p">),</span> <span class="n">v</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span>

<span class="n">saveToRepo</span><span class="p">(</span><span class="n">drd</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "7d976bfddc8fefcd0cc8f7d77223dd0e"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">drd</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span> <span class="n">aes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">v</span><span class="p">))</span> <span class="o">+</span> 
  <span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">theme_RTCGA</span><span class="p">()</span> <span class="o">+</span> <span class="n">xlab</span><span class="p">(</span><span class="s2">"Date of the release"</span><span class="p">)</span> <span class="o">+</span> 
  <span class="n">ylab</span><span class="p">(</span><span class="s2">"# of patients"</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"BRCA"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error: ggplot2 doesn't know how to deal with data of class POSIXct/POSIXt</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">saveToRepo</span><span class="p">(</span><span class="n">.Last.value</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[1] "f9e884084b84794d762a535f3facec85"</code></pre></figure>

<h2 id="p-values-for-selected-genes">4. p-values for selected genes</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">pvalues</span> <span class="o">&lt;-</span> <span class="n">pvalues</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">length</span><span class="p">(</span><span class="n">names</span><span class="p">),]</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in pvalues[1:length(names), ]: subscript out of bounds</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plotPValues</span> <span class="o">&lt;-</span> <span class="k">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">drd</span> <span class="o">&lt;-</span> <span class="n">data.frame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">ymd</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="m">62</span><span class="p">,</span> <span class="m">69</span><span class="p">)),</span> 
                    <span class="n">v</span> <span class="o">=</span> <span class="n">pvalues</span><span class="p">[,</span><span class="n">i</span><span class="p">],</span> 
                    <span class="n">p</span> <span class="o">=</span> <span class="m">1</span><span class="o">-</span><span class="n">pchisq</span><span class="p">(</span><span class="n">pvalues</span><span class="p">[,</span><span class="n">i</span><span class="p">],</span><span class="m">1</span><span class="p">))</span>
  <span class="n">drd</span> <span class="o">&lt;-</span> <span class="n">drd</span><span class="p">[</span><span class="n">drd</span><span class="o">$</span><span class="n">v</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">,]</span>
  <span class="n">drd</span> <span class="o">&lt;-</span> <span class="n">drd</span><span class="p">[</span><span class="m">-1</span><span class="p">,]</span>
  
  <span class="n">ggplot</span><span class="p">(</span><span class="n">drd</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">signif</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="m">2</span><span class="p">)))</span> <span class="o">+</span> 
    <span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">xlab</span><span class="p">(</span><span class="s2">"Date of the release"</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">ylab</span><span class="p">(</span><span class="s2">"p-value (survival model)\n for data from this release"</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">drd</span><span class="p">[</span><span class="n">c</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">drd</span><span class="o">$</span><span class="n">p</span><span class="p">),</span> <span class="n">which.min</span><span class="p">(</span><span class="n">drd</span><span class="o">$</span><span class="n">p</span><span class="p">)),],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span> <span class="n">nudge_y</span> <span class="o">=</span> <span class="m">.025</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">ggtitle</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"Gene: "</span><span class="p">,</span> <span class="n">colnames</span><span class="p">(</span><span class="n">all</span><span class="p">)[</span><span class="n">selected</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span> <span class="o">+</span> <span class="n">theme_RTCGA</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">plotPValues</span><span class="p">(</span> <span class="m">135</span> <span class="p">)</span></code></pre></figure>

<p><img src="/RTCGA/figure/source/Usecases/unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plotPValues</span><span class="p">(</span> <span class="m">47</span> <span class="p">)</span></code></pre></figure>

<p><img src="/RTCGA/figure/source/Usecases/unnamed-chunk-9-2.png" alt="plot of chunk unnamed-chunk-9" /></p>

<h2 id="low-p-value-small-group">5. Low p-value, small group</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">all</span> <span class="o">&lt;-</span> <span class="n">read_and_joinTCGA</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="m">20</span><span class="p">])</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in if (input == "" || length(grep("\\n|\\r", input)) &gt; 0) {: missing value where TRUE/FALSE needed</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">j</span> <span class="o">&lt;-</span> <span class="m">15789+4</span>
<span class="c1">#all[,j] &lt;- as.numeric(as.character(all[,j]))
</span>
<span class="n">vv</span> <span class="o">&lt;-</span> <span class="n">cut</span><span class="p">(</span><span class="n">all</span><span class="p">[,</span><span class="n">j</span><span class="p">],</span> <span class="n">c</span><span class="p">(</span><span class="m">-100</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">100</span><span class="p">),</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"low expression"</span><span class="p">,</span> <span class="s2">"high expression"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in all[, j]: object of type 'builtin' is not subsettable</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ndf</span> <span class="o">&lt;-</span> <span class="n">data.frame</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">pmax</span><span class="p">(</span><span class="n">all</span><span class="o">$</span><span class="n">times</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">event</span> <span class="o">=</span> <span class="n">all</span><span class="o">$</span><span class="n">patient.vital_status</span> <span class="o">==</span><span class="m">1</span><span class="p">,</span> 
                  <span class="n">var</span> <span class="o">=</span> <span class="n">vv</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in all$times: object of type 'builtin' is not subsettable</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ndf</span> <span class="o">&lt;-</span> <span class="n">na.omit</span><span class="p">(</span><span class="n">ndf</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in na.omit(ndf): object 'ndf' not found</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">kmTCGA</span><span class="p">(</span><span class="n">ndf</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="s2">"time"</span><span class="p">,</span>
			 <span class="n">status</span> <span class="o">=</span> <span class="s2">"event"</span><span class="p">,</span>
			 <span class="n">explanatory.names</span> <span class="o">=</span> <span class="s2">"var"</span><span class="p">,</span>
			 <span class="n">main</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s2">"Gene:"</span><span class="p">,</span> <span class="n">colnames</span><span class="p">(</span><span class="n">all</span><span class="p">)[</span><span class="n">j</span><span class="p">]))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Error in is.data.frame(x): object 'ndf' not found</code></pre></figure>


  
  <a href="https://twitter.com/share" class="twitter-share-button"{count}>Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  
  
  
  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-share-button" data-href="https://rtcga.github.io/RTCGA" data-layout="button_count"></div>
  

  
  
<div id="disqus_thread"></div>

<script>(function() {
        var d = document, s = d.createElement('script');
        s.src = '//RTCGA.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  
</div>



    </div>

  </body>
</html>
